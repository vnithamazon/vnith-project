CREATE TABLE employees (
    EMPLOYEE_ID SERIAL PRIMARY KEY,
    NAME TEXT NOT NULL,
    DEPARTMENT TEXT,
    EMAIL TEXT UNIQUE,
    PHONE_NO NUMERIC(10,0),
    JOINING_DATE DATE,
    SALARY NUMERIC(10,2),
    BONUS NUMERIC(10,2),
    TAX_PERCENTAGE NUMERIC(5,2)
);

INSERT INTO employees (NAME, DEPARTMENT, EMAIL, PHONE_NO, JOINING_DATE, SALARY, BONUS, TAX_PERCENTAGE) VALUES
('John Doe', 'Sales', 'john.doe@example.com', 1234567890, '2023-01-15', 75000, 5000, 20),
('Jane Smith', 'Marketing', 'jane.smith@example.com', 2345678901, '2022-11-01', 80000, 6000, 22),
('Bob Johnson', 'IT', 'bob.johnson@example.com', 3456789012, '2023-03-01', 90000, 7000, 25),
('Alice Brown', 'HR', 'alice.brown@example.com', 4567890123, '2022-09-15', 70000, 4000, 18),
('Charlie Davis', 'Sales', 'charlie.davis@example.com', 5678901234, '2023-02-01', 78000, 5500, 21),
('Eva White', 'IT', 'eva.white@example.com', 6789012345, '2022-12-01', 95000, 8000, 26),
('Frank Miller', 'Marketing', 'frank.miller@example.com', 7890123456, '2023-04-01', 82000, 6200, 23),
('Grace Lee', 'HR', 'grace.lee@example.com', 8901234567, '2022-10-15', 72000, 4200, 19),
('Henry Wilson', 'Sales', 'henry.wilson@example.com', 9012345678, '2023-01-01', 76000, 5100, 20),
('Ivy Chen', 'IT', 'ivy.chen@example.com', 1234509876, '2022-08-01', 98000, 8500, 27);

SELECT * FROM employees ORDER BY SALARY DESC;

SELECT NAME, DEPARTMENT, (SALARY + BONUS) AS TOTAL_COMPENSATION
FROM employees
WHERE (SALARY + BONUS) > 100000;

UPDATE employees
SET BONUS = BONUS * 1.1
WHERE DEPARTMENT = 'Sales';

SELECT NAME, SALARY, BONUS, TAX_PERCENTAGE,
       (SALARY + BONUS) * (1 - TAX_PERCENTAGE / 100) AS NET_SALARY
FROM employees;

SELECT DEPARTMENT,
       ROUND(AVG(SALARY), 2) AS AVG_SALARY,
       MIN(SALARY) AS MIN_SALARY,
       MAX(SALARY) AS MAX_SALARY
FROM employees
GROUP BY DEPARTMENT;

SELECT NAME, DEPARTMENT, JOINING_DATE
FROM employees
WHERE JOINING_DATE >= CURRENT_DATE - INTERVAL '6 months';

SELECT DEPARTMENT, COUNT(*) AS EMPLOYEE_COUNT
FROM employees
GROUP BY DEPARTMENT;

SELECT DEPARTMENT, ROUND(AVG(SALARY), 2) AS AVG_SALARY
FROM employees
GROUP BY DEPARTMENT
ORDER BY AVG_SALARY DESC
LIMIT 1;

SELECT e1.NAME, e1.SALARY
FROM employees e1
JOIN employees e2 ON e1.SALARY = e2.SALARY AND e1.EMPLOYEE_ID <> e2.EMPLOYEE_ID
GROUP BY e1.EMPLOYEE_ID, e1.NAME, e1.SALARY
ORDER BY e1.SALARY;
